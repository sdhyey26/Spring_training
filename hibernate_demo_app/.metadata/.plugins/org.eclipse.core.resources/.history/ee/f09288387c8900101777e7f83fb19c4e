package com.tss.service;

public class ImageServiceImpl implements ImageService {
    @Autowired
    private ImageRepository imageRepository;

    @Override
    public String uploadImage(MultipartFile file) {
        try {
            ImageEntity image = new ImageEntity(
                    file.getOriginalFilename(),
                    file.getContentType(),
                    file.getBytes()
            );
            imageRepository.save(image);
            return "Image uploaded successfully: " + file.getOriginalFilename();
        } catch (IOException e) {
            throw new RuntimeException("Failed to store file " + file.getOriginalFilename(), e);
        }
    }

    @Override
    public ImageResponseDto getImage(Long id) {
        ImageEntity image = imageRepository.findById(id)
                .orElseThrow(() -> new ResourceNotFoundException("Image not found with id: " + id));

        return new ImageResponseDto(
                image.getName(),
                image.getType(),
                image.getData()
        );
    }
}
